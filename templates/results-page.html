<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Result</title>
    <!-- <link rel="stylesheet" href="styles.css"> Link to CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>

<header>
    <span>Health Scan AI</span>
</header>
<hr>

<body>
    <div class="result-container">
        <p><b>Results:</b></p>
        <h2 id="prediction-output">You are …</h2>
        <p id="vote-breakdown"></p>
        <ul id="confidence-list"></ul>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
          const result   = sessionStorage.getItem("predictionResult");
          const conf     = sessionStorage.getItem("predictionConfidence");
          const votesStr = sessionStorage.getItem("votes");
          const confsStr = sessionStorage.getItem("confidences");
        
          // render final line
          const output = document.getElementById("prediction-output");
          if (result && conf) {
            output.innerText =
            //   `You are ${result} (confidence: ${parseFloat(conf).toFixed(2)})`;
            `You are ${result}`;
          } else {
            output.innerText = "No prediction available. Please try again.";
            return;
          }
        
          // votes breakdown
          let votes = { Sick: 0, Healthy: 0 };
          if (votesStr) {
            try { votes = JSON.parse(votesStr); } catch (e) { /* ignore */ }
          }
          document.getElementById("vote-breakdown").innerText =
            `Votes → Sick: ${votes.Sick}, Healthy: ${votes.Healthy}`;
        
          // per-feature confidences
          const ul = document.getElementById("confidence-list");
          if (confsStr) {
            let confs = {};
            try { confs = JSON.parse(confsStr); } catch (e) { /* ignore */ }
            Object.entries(confs).forEach(([feature, score]) => {
              const li = document.createElement("li");
              li.innerText = `${feature}: ${parseFloat(score).toFixed(2)}`;
              ul.appendChild(li);
            });
          }
        });
    </script>   
</body>
</html>